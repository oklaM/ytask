# 简化的定时配置系统使用指南

## 概述

本系统提供了一个简化的定时配置方案，兼顾了基础用户和进阶用户的需求。系统将定时配置分为"基础定时"和"高级选项"两个选项卡，让不同层次的用户都能方便地配置定时任务。

## 主要特性

### 1. 基础定时选项

#### 可视化定时
- **一次性定时**: 设置每天的固定时间执行
- **分钟循环**: 按分钟间隔重复执行
- **小时循环**: 按小时间隔重复执行
- **天循环**: 按天间隔重复执行
- **周循环**: 按周重复，可指定具体星期几
- **月循环**: 按月份重复，可指定具体日期

#### 倒计时触发
- 设置倒计时时间（小时、分钟、秒）
- 从指定时间开始倒计时
- 倒计时结束后自动触发任务

#### 农历定时
- 支持农历日期设置
- 可设置每年重复
- 特别适合节日提醒

#### 固定间隔和特定时间
- 保留原有的固定间隔和特定时间配置

### 2. 高级选项

#### Cron表达式
- 为程序员和进阶用户提供
- 支持完整的Cron语法
- 提供常用Cron表达式示例

#### 条件触发
- 系统启动后延迟执行
- 系统休眠恢复后触发
- CPU占用率低于阈值时执行
- 内存使用率低于阈值时执行
- 网络活动检测触发

## 使用说明

### 基础定时配置

1. **打开任务创建页面**
2. **选择"基础定时"选项卡**
3. **选择触发类型**:
   - **可视化定时**: 适合日常重复任务
   - **倒计时触发**: 适合延迟执行任务
   - **农历定时**: 适合节日提醒
   - **固定间隔**: 简单的时间间隔
   - **特定时间**: 单次执行任务

#### 可视化定时示例

```javascript
// 每天上午9点执行
{
  "visualType": "once",
  "visualTime": "09:00"
}

// 每30分钟执行一次
{
  "visualType": "minute",
  "visualValue": 30
}

// 每周一、三、五的下午2点执行
{
  "visualType": "week",
  "visualTime": "14:00",
  "visualDays": [1, 3, 5]
}
```

#### 农历定时示例

```javascript
// 每年农历正月初一执行
{
  "lunarYear": 2024,
  "lunarMonth": 1,
  "lunarDay": 1,
  "lunarRepeat": true
}
```

### 高级选项配置

1. **切换到"高级选项"选项卡**
2. **选择触发类型**:
   - **Cron表达式**: 精确的定时控制
   - **条件触发**: 基于系统状态的触发

#### Cron表达式示例

```bash
# 每天午夜执行
0 0 * * *

# 每小时执行
0 * * * *

# 工作日早上9点执行
0 9 * * 1-5

# 每月1号和15号的凌晨2点执行
0 2 1,15 * *
```

#### 条件触发示例

```javascript
// 系统启动后5分钟执行
{
  "conditionType": "system_startup",
  "conditionDelay": 300000  // 5分钟
}

// CPU占用率低于30%时执行
{
  "conditionType": "cpu_usage",
  "conditionValue": 30
}
```

## 技术实现

### 前端组件

1. **VisualTimerSelector**: 可视化定时选择器
2. **LunarCalendarSelector**: 农历日历选择器
3. **CountdownTimer**: 倒计时配置组件
4. **ConditionTrigger**: 条件触发配置组件

### 后端支持

1. **扩展了数据库表结构**，支持新的触发类型
2. **增强了任务调度器**，支持各种定时计算
3. **提供了统一的API接口**，兼容原有系统

## 优势特点

1. **用户友好**: 基础用户无需学习复杂的Cron语法
2. **功能全面**: 覆盖了各种常见的定时需求
3. **灵活扩展**: 支持条件触发等高级功能
4. **向后兼容**: 不影响原有的定时任务配置
5. **模块化设计**: 各个定时类型独立，便于维护和扩展

## 最佳实践

1. **日常任务**: 使用"可视化定时"
2. **节日提醒**: 使用"农历定时"
3. **精确控制**: 使用"Cron表达式"
4. **系统监控**: 使用"条件触发"
5. **延迟执行**: 使用"倒计时触发"

## 故障排除

1. **定时不准确**: 检查系统时区设置
2. **农历转换错误**: 确保输入的农历日期正确
3. **条件触发失败**: 检查系统监控功能是否正常
4. **倒计时未触发**: 确认倒计时开始时间设置正确

## 更新日志

- **v1.0** (2024-11-13): 实现简化的定时配置系统
- 新增4种定时类型
- 优化用户界面
- 增强后端调度能力

---

如有问题，请参考各个组件的详细文档或联系技术支持。